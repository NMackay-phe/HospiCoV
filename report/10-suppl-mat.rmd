# Supplementary material

```{r, include = F, cache = F}
source("report-functions.R")
```

## Scenario 1: R0 at 3
### First month: 10 March 2020 to 07 April 2020
#### Outcomes by region

```{r}
## Run model
outcomes = run_model(R0 = 3)
## At 1 month
data1 = outcomes[Time < as.Date("2020-04-08"), ]
## From month 1 to 2
data2 = outcomes[Time >= as.Date("2020-04-08") & Time < as.Date("2020-05-07"), ]
## Both months
data1and2 = outcomes[Time < as.Date("2020-05-07"), ]
```

```{r}
outcomes_byreg = get_outcomes_byreg(data = data1)

caption = "Predicted number of infected cases, severe cases, cases admitted into intensive care units, cases requiring ventilation (invasive or not), and deaths, from 10 March 2020 to 07 April 2020, by region."
knitr::kable(outcomes_byreg,
             digits = 0,
             caption = caption)
```

#### Hospital needs by region

```{r}
bedreq_byreg = get_bedreq_byreg(data = data1)

caption = "Predicted number of needed hospital bed-days, ICU bed-days, and invasive ventilation bed-days, from 10 March 2020 to 07 April 2020, by region."
knitr::kable(bedreq_byreg,
             digits = 0,
             caption = caption)
```


### Second month: 08 April 2020 to 06 May 2020
#### Outcomes by region

```{r}
outcomes_byreg = get_outcomes_byreg(data = data2)

caption = "Predicted number of infected cases, severe cases, cases admitted into intensive care units, cases requiring ventilation (invasive or not), and deaths, from 08 April 2020 to 06 May 2020, by region."
knitr::kable(outcomes_byreg,
             digits = 0,
             caption = caption)
```

#### Hospital needs by region

```{r}
bedreq_byreg = get_bedreq_byreg(data = data2)

caption = "Predicted number of needed hospital bed-days, ICU bed-days, and invasive ventilation bed-days, from 08 April 2020 to 06 May 2020, by region."
knitr::kable(bedreq_byreg,
             digits = 0,
             caption = caption)
```



### Epidemic curves of infected cases and deaths, by age group, over both months (10 March 2020 to 06 May 2020)


```{r, cache = F, dev = 'svg'}
## Case time series, all age groups
data = data1and2[, .(Infected = sum(Infected)), by = c("Time","AgeGroup")]
data[, CumInf := cumsum(Infected), by = AgeGroup]

p = ggplot(data, aes(x = Time, y = CumInf, color = AgeGroup)) +
    theme_classic() +
    geom_line() +
    scale_y_continuous("Cumulated") +
    ggtitle("Predicted number of infected cases from 10 March 2020 to 06 May 2020, for all France, by age group.")

p

```

```{r, cache = F, dev = 'svg'}
## Deaths time series, all age groups
data = data1and2[, .(Deaths = sum(deaths)), by = c("Time","AgeGroup")]
data[, CumDeaths := cumsum(Deaths), by = AgeGroup]

p = ggplot(data, aes(x = Time, y = CumDeaths, color = AgeGroup)) +
    theme_classic() +
    geom_line() +
    scale_y_continuous("Cumulated") +
    ggtitle("Predicted number of deaths from 10 March 2020 to 06 May 2020, for all France, by age group.")

p

```



## Scenario 2: R0 at 2.5

```{r}
## Run model
outcomes = run_model(R0 = 2.5)
## At 1 month
data1 = outcomes[Time < as.Date("2020-04-08"), ]
## From month 1 to 2
data2 = outcomes[Time >= as.Date("2020-04-08") & Time < as.Date("2020-05-07"), ]
## Both months
data1and2 = outcomes[Time < as.Date("2020-05-07"), ]
```

### First month: 10 March 2020 to 07 April 2020
#### Outcomes by region

```{r}
outcomes_byreg = get_outcomes_byreg(data = data1)

caption = "Predicted number of infected cases, severe cases, cases admitted into intensive care units, cases requiring ventilation (invasive or not), and deaths, from 10 March 2020 to 07 April 2020, by region."
knitr::kable(outcomes_byreg,
             digits = 0,
             caption = caption)
```

#### Hospital needs by region

```{r}
bedreq_byreg = get_bedreq_byreg(data = data1)

caption = "Predicted number of needed hospital bed-days, ICU bed-days, and invasive ventilation bed-days, from 10 March 2020 to 07 April 2020, by region."
knitr::kable(bedreq_byreg,
             digits = 0,
             caption = caption)
```


### Second month: 08 April 2020 to 06 May 2020
#### Outcomes by region

```{r}
outcomes_byreg = get_outcomes_byreg(data = data2)

caption = "Predicted number of infected cases, severe cases, cases admitted into intensive care units, cases requiring ventilation (invasive or not), and deaths, from 08 April 2020 to 06 May 2020, by region."
knitr::kable(outcomes_byreg,
             digits = 0,
             caption = caption)
```

#### Hospital needs by region

```{r}
bedreq_byreg = get_bedreq_byreg(data = data2)

caption = "Predicted number of needed hospital bed-days, ICU bed-days, and invasive ventilation bed-days, from 08 April 2020 to 06 May 2020, by region."
knitr::kable(bedreq_byreg,
             digits = 0,
             caption = caption)
```



### Epidemic curves of infected cases and deaths, by age group, over both months (10 March 2020 to 06 May 2020)


```{r, cache = F, dev = 'svg'}
## Case time series, all age groups
data = data1and2[, .(Infected = sum(Infected)), by = c("Time","AgeGroup")]
data[, CumInf := cumsum(Infected), by = AgeGroup]

p = ggplot(data, aes(x = Time, y = CumInf, color = AgeGroup)) +
    theme_classic() +
    geom_line() +
    scale_y_continuous("Cumulated") +
    ggtitle("Predicted number of infected cases from 10 March 2020 to 06 May 2020, for all France, by age group.")

p

```

```{r, cache = F, dev = 'svg'}
## Deaths time series, all age groups
data = data1and2[, .(Deaths = sum(deaths)), by = c("Time","AgeGroup")]
data[, CumDeaths := cumsum(Deaths), by = AgeGroup]

p = ggplot(data, aes(x = Time, y = CumDeaths, color = AgeGroup)) +
    theme_classic() +
    geom_line() +
    scale_y_continuous("Cumulated") +
    ggtitle("Predicted number of deaths from 10 March 2020 to 06 May 2020, for all France, by age group.")

p

```


## Scenario 2: R0 at 2

```{r}
## Run model
outcomes = run_model(R0 = 2)
## At 1 month
data1 = outcomes[Time < as.Date("2020-04-08"), ]
## From month 1 to 2
data2 = outcomes[Time >= as.Date("2020-04-08") & Time < as.Date("2020-05-07"), ]
## Both months
data1and2 = outcomes[Time < as.Date("2020-05-07"), ]
```

### First month: 10 March 2020 to 07 April 2020
#### Outcomes by region

```{r}
outcomes_byreg = get_outcomes_byreg(data = data1)

caption = "Predicted number of infected cases, severe cases, cases admitted into intensive care units, cases requiring ventilation (invasive or not), and deaths, from 10 March 2020 to 07 April 2020, by region."
knitr::kable(outcomes_byreg,
             digits = 0,
             caption = caption)
```

#### Hospital needs by region

```{r}
bedreq_byreg = get_bedreq_byreg(data = data1)

caption = "Predicted number of needed hospital bed-days, ICU bed-days, and invasive ventilation bed-days, from 10 March 2020 to 07 April 2020, by region."
knitr::kable(bedreq_byreg,
             digits = 0,
             caption = caption)
```


### Second month: 08 April 2020 to 06 May 2020
#### Outcomes by region

```{r}
outcomes_byreg = get_outcomes_byreg(data = data2)

caption = "Predicted number of infected cases, severe cases, cases admitted into intensive care units, cases requiring ventilation (invasive or not), and deaths, from 08 April 2020 to 06 May 2020, by region."
knitr::kable(outcomes_byreg,
             digits = 0,
             caption = caption)
```

#### Hospital needs by region

```{r}
bedreq_byreg = get_bedreq_byreg(data = data2)

caption = "Predicted number of needed hospital bed-days, ICU bed-days, and invasive ventilation bed-days, from 08 April 2020 to 06 May 2020, by region."
knitr::kable(bedreq_byreg,
             digits = 0,
             caption = caption)
```



### Epidemic curves of infected cases and deaths, by age group, over both months (10 March 2020 to 06 May 2020)

```{r, cache = F, dev = 'svg'}
## Case time series, all age groups
data = data1and2[, .(Infected = sum(Infected)), by = c("Time","AgeGroup")]
data[, CumInf := cumsum(Infected), by = AgeGroup]

p = ggplot(data, aes(x = Time, y = CumInf, color = AgeGroup)) +
    theme_classic() +
    geom_line() +
    scale_y_continuous("Cumulated") +
    ggtitle("Predicted number of infected cases from 10 March 2020 to 06 May 2020, for all France, by age group.")

p

```

```{r, cache = F, dev = 'svg'}
## Deaths time series, all age groups
data = data1and2[, .(Deaths = sum(deaths)), by = c("Time","AgeGroup")]
data[, CumDeaths := cumsum(Deaths), by = AgeGroup]

p = ggplot(data, aes(x = Time, y = CumDeaths, color = AgeGroup)) +
    theme_classic() +
    geom_line() +
    scale_y_continuous("Cumulated") +
    ggtitle("Predicted number of deaths from 10 March 2020 to 06 May 2020, for all France, by age group.")

p

```


## Scenario 2: R0 at 1.5

```{r}
## Run model
outcomes = run_model(R0 = 1.5)
## At 1 month
data1 = outcomes[Time < as.Date("2020-04-08"), ]
## From month 1 to 2
data2 = outcomes[Time >= as.Date("2020-04-08") & Time < as.Date("2020-05-07"), ]
## Both months
data1and2 = outcomes[Time < as.Date("2020-05-07"), ]
```

### First month: 10 March 2020 to 07 April 2020
#### Outcomes by region

```{r}
outcomes_byreg = get_outcomes_byreg(data = data1)

caption = "Predicted number of infected cases, severe cases, cases admitted into intensive care units, cases requiring ventilation (invasive or not), and deaths, from 10 March 2020 to 07 April 2020, by region."
knitr::kable(outcomes_byreg,
             digits = 0,
             caption = caption)
```

#### Hospital needs by region

```{r}
bedreq_byreg = get_bedreq_byreg(data = data1)

caption = "Predicted number of needed hospital bed-days, ICU bed-days, and invasive ventilation bed-days, from 10 March 2020 to 07 April 2020, by region."
knitr::kable(bedreq_byreg,
             digits = 0,
             caption = caption)
```


### Second month: 08 April 2020 to 06 May 2020
#### Outcomes by region

```{r}
outcomes_byreg = get_outcomes_byreg(data = data2)

caption = "Predicted number of infected cases, severe cases, cases admitted into intensive care units, cases requiring ventilation (invasive or not), and deaths, from 08 April 2020 to 06 May 2020, by region."
knitr::kable(outcomes_byreg,
             digits = 0,
             caption = caption)
```

#### Hospital needs by region

```{r}
bedreq_byreg = get_bedreq_byreg(data = data2)

caption = "Predicted number of needed hospital bed-days, ICU bed-days, and invasive ventilation bed-days, from 08 April 2020 to 06 May 2020, by region."
knitr::kable(bedreq_byreg,
             digits = 0,
             caption = caption)
```



### Epidemic curves of infected cases and deaths, by age group, over both months (10 March 2020 to 06 May 2020)

```{r, cache = F, dev = 'svg'}
## Case time series, all age groups
data = data1and2[, .(Infected = sum(Infected)), by = c("Time","AgeGroup")]
data[, CumInf := cumsum(Infected), by = AgeGroup]

p = ggplot(data, aes(x = Time, y = CumInf, color = AgeGroup)) +
    theme_classic() +
    geom_line() +
    scale_y_continuous("Cumulated") +
    ggtitle("Predicted number of infected cases from 10 March 2020 to 06 May 2020, for all France, by age group.")

p

```

```{r, cache = F, dev = 'svg'}
## Deaths time series, all age groups
data = data1and2[, .(Deaths = sum(deaths)), by = c("Time","AgeGroup")]
data[, CumDeaths := cumsum(Deaths), by = AgeGroup]

p = ggplot(data, aes(x = Time, y = CumDeaths, color = AgeGroup)) +
    theme_classic() +
    geom_line() +
    scale_y_continuous("Cumulated") +
    ggtitle("Predicted number of deaths from 10 March 2020 to 06 May 2020, for all France, by age group.")

p

```


## Best and worst case scenarios: R0 at 1.5 and 3


### First month

### Second month

```{r}
## table = range_table(outcomes15_byreg2, outcomes3_byreg2)
## caption = "Predicted range of infected cases, severe cases, cases admitted into intensive care units, cases requiring ventilation (invasive or not), and deaths, from 08 April 2020 to 06 May 2020, by region, for a R0 of 1.5 to 3."
## knitr::kable(table,
##              digits = 0,
##              caption = caption)

```
